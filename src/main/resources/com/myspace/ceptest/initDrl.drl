package com.myspace.ceptest;
import fraud.analysis.demo.transaction.Transaction;
import fraud.analysis.demo.transaction.CEPFraud;

declare Transaction @role( event )  @timestamp( timestamp ) end

rule "tet"
when
tn: transaction()
accumulate ($b:Transaction(this.transactionType == tn.transactionId, this.merchantType==tn.merchantType,(tn.timestamp - this.timestamp) <60000) from entry-point Reference;
$number: count($b);$number > 2)
then
CEPFraud cepFraud = new CEPFraud();
cepFraud.setTransaction(tn);
cepFraud.setFraudReason("More than 2 txns for Web purchases for the merchant");
insert(cepFraud);
end

